---
layout: default
title: ì•¼ìƒì˜ ìœ ë‹ˆì½”ë“œ
date: 2014-06-20
tags: unicode
---

ìœ ë‹ˆì½”ë“œë¥¼ ì‹¤ì œ í™˜ê²½ì—ì„œ ì‚¬ìš©í•˜ë ¤ë©´ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ì™€ OS í™˜ê²½ì´ ìœ ë‹ˆì½”ë“œë¥¼ ì–´ë–»ê²Œ ì§€ì›í•˜ëŠ”ì§€
ì•Œê³  ìˆì–´ì•¼ í•©ë‹ˆë‹¤.
ì¸ì½”ë”© ì´ìŠˆê°€ ìˆë‹¤ê±°ë‚˜, ìœ ë‹ˆì½”ë“œê°€ ì•„ë‹Œ ë°ì´í„°ë¥¼ ìœ ë‹ˆì½”ë“œë¼ê³  ê°€ì •í•œë‹¤ê±°ë‚˜,
BMP ì˜ì—­ë§Œ ì§€ì›í•˜ê³  ìˆë‹¤ê±°ë‚˜ í•˜ëŠ” ê²ƒì„ ëª¨ë¥´ê³  ì‘ì—…í•˜ë‹¤ ë³´ë©´
ë‚˜ì¤‘ì— ì˜ˆìƒì¹˜ ëª»í•œ ë¬¸ì œê°€ ë°œìƒí•˜ê¸° ì‰½ìŠµë‹ˆë‹¤.
ì´ ê¸€ì—ì„œëŠ” ê·¸ëŸ¬í•œ í•¨ì •ë“¤ì„ ì •ë¦¬í•´ ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

(ì´ ê¸€ì—ì„œëŠ” ìœ ë‹ˆì½”ë“œ, UTF-8, UTF-16 ë“±ì˜ ê¸°ë³¸ ê°œë…ì„ ì•Œê³  ìˆë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤.)

# Surrogates, UTF-16, UCS2

Surrogate pairëŠ” UTF-16 ì¸ì½”ë”©ì„ ìœ„í•´ì„œë§Œ ì‚¬ìš©í•˜ë„ë¡ ì§€ì •ëœ ìœ ë‹ˆì½”ë“œ ì˜ì—­ìœ¼ë¡œ,
`U+D800 ~ U+DBFF`(high surrogates)ì™€ `U+DC00 ~ U+DFFF`(low surrogates)ê°€ ì¡´ì¬í•©ë‹ˆë‹¤.
BMP ì˜ì—­ì„ ë²—ì–´ë‚˜ëŠ” ë¬¸ì(supplementary plane ì˜ì—­)ëŠ” UTF-16ì—ì„œ
high surrogateì™€ low surrogateì˜ ì¡°í•©ìœ¼ë¡œ í‘œí˜„ë©ë‹ˆë‹¤.
(ë‘ surrogateê°€ ì§ì´ ë§ì§€ ì•ŠëŠ”ë‹¤ë©´ ì¸ì½”ë”©ì´ ì˜ëª»ëœ ê²ƒì…ë‹ˆë‹¤.)

surrogate ì˜ì—­ì€ [Unicode scalar value][unicode-scalar-value]ì—ì„œ ì œì™¸ë˜ë©°,
UTF-16ì—ì„œëŠ” ì´ 'ë¬¸ì'ë¥¼ ì¸ì½”ë”©í•  ë°©ë²• ìì²´ê°€ ì—†ìŠµë‹ˆë‹¤.
UTF-8ì—ì„œ í‘œí˜„í•˜ëŠ” ê²ƒì€ ê¸°ìˆ ì ìœ¼ë¡œ ê°€ëŠ¥í•˜ì§€ë§Œ í‘œì¤€ì—ì„œ ëª…ì‹œì ìœ¼ë¡œ ê¸ˆì§€í•˜ê³  ìˆìŠµë‹ˆë‹¤.
ì´ëŸ¬í•œ íŠ¹ì§•ìœ¼ë¡œ ì¸í•´, 'ìœ ë‹ˆì½”ë“œ ë¬¸ì'ë¥¼ ë§í•  ë•ŒëŠ” surrogate pair ì˜ì—­ì„ ì œì™¸í•œ
scalar valueë¥¼ ë§í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

UCS2ëŠ”.. surrogateë„ ì—†ê³  BMP ì´ì™¸ì˜ ë¬¸ìë„ ì—†ì—ˆë˜ ì‹œì ˆì˜ 2ë°”ì´íŠ¸ ì¸ì½”ë”© ë°©ë²•ì…ë‹ˆë‹¤.
ì—¬ê¸°ì—ì„œëŠ” surrogate ì½”ë“œ ì—­ì‹œ (í• ë‹¹ë§Œ ì•ˆ ë˜ì–´ ìˆëŠ”)í‰ë²”í•œ ë¬¸ìì´ê¸° ë•Œë¬¸ì—
UCS2ë¡œ í‘œí˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì—¬ê¸°ì—ì„œ ì¼ë¶€ í˜¸í™˜ì„± ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤ëŠ” ì ì„ ìœ ì˜í•´ë‘˜ í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤.
ì˜ˆë¥¼ ë“¤ì–´, `0xD800 0xD800`ì€ UCS2ë¡œ í•´ì„í•  ê²½ìš° ë¬¸ì œê°€ ì—†ì§€ë§Œ UTF-16ìœ¼ë¡œ í•´ì„í•  ê²½ìš°
'ì¸ì½”ë”© ì—ëŸ¬'ê°€ ë©ë‹ˆë‹¤.
ë°˜ëŒ€ë¡œ, `0xD800 0xDC00`ì€ UTF-16ìœ¼ë¡œ í•´ì„í•  ê²½ìš° `U+00010000`ê°€ ë˜ì§€ë§Œ
UCS2ë¡œ í•´ì„í•  ê²½ìš° `U+D800 U+DC00`ì´ ë©ë‹ˆë‹¤.

ì´ëŸ° ì´ìƒí•œ ê°’ë“¤ì„ ì‹¤ì œë¡œ ì‚¬ìš©í•  ì¼ì´ ìˆì„ê¹Œ ì‹¶ì§€ë§Œ,
ì •ë§ ì§„ì§œë¡œ ë“±ì¥í•˜ê¸° ë•Œë¬¸ì— ì£¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤.
íŠ¹íˆ, ìœ ë‹ˆì½”ë“œë¥¼ ë‹¤ë£¨ëŠ” í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë‚˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ì´ë“¤ì„ ë‚´ë¶€ì ìœ¼ë¡œ ì“¸ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

ë”ìš± í—·ê°ˆë¦¬ëŠ” ì¼€ì´ìŠ¤ëŠ” "ìœ ë‹ˆì½”ë“œ"ë¥¼ ì§€ì›í•œë‹¤ë©´ì„œ UCS2ë¥¼ ì§€ì›í•˜ëŠ” ê²½ìš°ì…ë‹ˆë‹¤.
ì–¼í• ë³´ê¸°ì—ëŠ” UTF-16ì´ ì§€ì›ë˜ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì´ì§€ë§Œ, ì˜ëª»ëœ UTF-16 ì¸ì½”ë”©ì„ ì—ëŸ¬ ì—†ì´ ë°›ì•„ë“¤ì¸ë‹¤ê±°ë‚˜,
ë¬¸ìì—´ ê¸¸ì´ë¥¼ ì²´í¬í–ˆëŠ”ë° UTF-16ê³¼ ê²°ê³¼ê°€ ë‹¤ë¥´ë‹¤ê±°ë‚˜ í•˜ëŠ” ì¼ì´ ë²Œì–´ì§‘ë‹ˆë‹¤. ì£¼ì˜í•˜ì„¸ìš”!

# UTF-8 overlong encodings

UTF-8ì—ì„œëŠ” ê¸°ìˆ ì ìœ¼ë¡œëŠ” í•˜ë‚˜ì˜ ìœ ë‹ˆì½”ë“œ ë¬¸ìê°€ ì—¬ëŸ¬ ë°”ì´íŠ¸ì—´ë¡œ ì¸ì½”ë”©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì˜ˆë¥¼ ë“¤ì–´ `U+0000`ì€ `0x00`ìœ¼ë¡œë„ ì¸ì½”ë”©í•  ìˆ˜ ìˆì§€ë§Œ, `0xC0 0x80`ìœ¼ë¡œ ì¸ì½”ë”©í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.
ì´ ê²½ìš° ë°”ì´íŠ¸ì—´ì—ì„œëŠ” `0x00`ì´ ë³´ì´ì§€ ì•Šê³ ìš”.
ë§Œì•½ ì™¸ë¶€ ì…ë ¥ ë¬¸ìì—´ì— `NULL`ì´ ìˆëŠ”ì§€ ê²€ì¦í•˜ë ¤ê³  í•œë‹¤ë©´,
ë°”ì´íŠ¸ì—´ì— `0x00`ì´ ìˆëŠ”ì§€ ê²€ì¦í•˜ëŠ” ê²ƒìœ¼ë¡œëŠ” ë¶€ì¡±í•  ìˆ˜ ìˆë‹¤ëŠ” ì˜ë¯¸ê°€ ë©ë‹ˆë‹¤.
ìì¹«í•˜ë©´ [ë³´ì•ˆ ë²„ê·¸ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆê² ì£ ][capec-80].

ê·¸ë˜ì„œ UTF-8ì—ì„œëŠ” ì´ëŸ¬í•œ ì“¸ë°ì—†ì´ ê¸´ ì¸ì½”ë”©(overlong encoding)ì„ ëª…ì‹œì ìœ¼ë¡œ ê¸ˆì§€í•©ë‹ˆë‹¤.
(ë¬¼ë¡  ì–´í”Œë¦¬ì¼€ì´ì…˜ì€ ì™¸ë¶€ ì…ë ¥ ë¬¸ìì—´ì´ ì •ìƒì ì¸ UTF-8ì¸ì§€ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤.)
ì§ì ‘ UTF-8 ë””ì½”ë”ë¥¼ ì‘ì„±í•œë‹¤ë©´ ì´ ë¶€ë¶„ì„ êµ¬í˜„í–ˆëŠ”ì§€,
ì¦‰ í•´ë‹¹ ë°”ì´íŠ¸ì—´ì„ ë„£ìœ¼ë©´ ëª…ì‹œì ì¸ ì—ëŸ¬ê°€ ë‚˜ëŠ”ì§€ ê¼­ í™•ì¸í•´ë´ì•¼ í•©ë‹ˆë‹¤.

# BOM

[BOM(byte order masrk)][unicode-faq-bom]ì€ ê·¼ë³¸ì ìœ¼ë¡œ ì—”ë””ì•ˆì„ ìœ„í•œ ì¡´ì¬ì…ë‹ˆë‹¤.
UTF-16ì´ë‚˜ UTF-32ë¥¼ 8ë¹„íŠ¸ ê¸°ì¤€ìœ¼ë¡œ ì €ì¥í•  ê²½ìš° 16ë¹„íŠ¸/32ë¹„íŠ¸ í•œ ë‹¨ìœ„ê°€ 8ë¹„íŠ¸ë¡œ ì–´ë–»ê²Œ ì €ì¥ë ì§€ ì•Œ ìˆ˜ ì—†ìœ¼ë‹ˆê¹Œ
`U+FEFF` ë¬¸ìë¥¼ ë§¨ ì•ì— ë¶™ì—¬ì„œ ìˆœì„œë¥¼ ì§ì‘í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ì¡´ì¬ì…ë‹ˆë‹¤.
ë¹… ì—”ë””ì•ˆì´ë©´ `0xFE 0xFF`, ë¦¬í‹€ ì—”ë””ì•ˆì´ë©´ `0xFF 0xFE`ì¼í…Œë‹ˆê¹Œìš”.

UTF-8ì—ì„œ BOMì€ ì•„ë¬´ëŸ° ê°€ì¹˜ë¥¼ ê°–ì§€ ëª»í•©ë‹ˆë‹¤.
ë¬¼ë¡  BOMì´ "ì´ íŒŒì¼ì€ UTF-8ì…ë‹ˆë‹¤"ë¼ëŠ” ì •ë³´ë¥¼ ì£¼ì§€ë§Œ,
ì• ì´ˆì— ì˜¤ëŠ˜ë‚ ì— UTF-8ì´ ì•„ë‹Œ ì¸ì½”ë”©ì´ ì¡´ì¬í•œë‹¤ëŠ” ê²ƒ ìì²´ê°€ ë¶ˆí–‰í•œ ìƒí™©ì…ë‹ˆë‹¤.
ê·¸ë¦¬ê³  BOMì„ ì²˜ë¦¬í•˜ì§€ ì•ŠëŠ” í”„ë¡œê·¸ë¨ ì…ì¥ì—ì„œëŠ” ë¶ˆí•„ìš”í•œ ë¬¸ìì¼ ë¿ì…ë‹ˆë‹¤.
ê°€ë”ì€ ì•„ë¬´ ë¬¸ìê°€ ì—†ì–´ì•¼ í•˜ëŠ”ë° BOM ë¬¸ìê°€ ìˆì–´ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ëŠ” ê²½ìš°ë„ ìˆìŠµë‹ˆë‹¤.

ë”ìš± ë¶ˆí–‰í•˜ê²Œë„ ëª‡ëª‡ ì—ë””í„°ëŠ” UTF-8ì— BOMì„ ë¶™ì´ëŠ” ìŠµê´€ì„ ê°€ì§€ê³  ìˆê³ ,
ì‹¬ì§€ì–´ ì–´ë–¤ ë…€ì„ë“¤ì€ BOMì´ ì—†ìœ¼ë©´ ì •ìƒì ì¸ ì¸ì½”ë”© ì¸ì‹ì— ì‹¤íŒ¨í•©ë‹ˆë‹¤!
ìœˆë„ ë©”ëª¨ì¥ì—ì„œëŠ” "ìœ ë‹ˆì½”ë“œ"ì™€ "UTF-8" ì¸ì½”ë”©ì„ ì§€ì›í•œë‹¤ê³  ë˜ì–´ ìˆì§€ë§Œ,
ìœ ë‹ˆì½”ë“œëŠ” UTF-16LEë¡œ ì €ì¥í•˜ë©° UTF-8ì€ BOMì„ ë¬´ì¡°ê±´ ë¶™ì…ë‹ˆë‹¤.
Visual Studio ì—­ì‹œ UTF-8ì— BOMì„ ì•ˆ ë¶™ì´ë©´ ì¸ì½”ë”©ì„ ì œëŒ€ë¡œ ì¸ì‹í•˜ì§€ ëª»í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

BOMì˜ ì •ì²´ëŠ” `U+FEFF`ë¼ëŠ” ìœ ë‹ˆì½”ë“œ ë¬¸ìì…ë‹ˆë‹¤.
ìƒëš±ë§ê²Œ [Arabic Presentation Forms-B][unicode-fe70] ì˜ì—­ì— í• ë‹¹ë˜ì–´ ìˆê³ ,
ìœ ë‹ˆì½”ë“œ 2.0ë¶€í„°ëŠ” ZERO WIDTH NO-BREAK SPACEë¼ëŠ” ì´ë¦„ì„ ê°–ìŠµë‹ˆë‹¤.
ì¦‰ ê²‰ìœ¼ë¡œëŠ” ë³´ì´ì§€ ì•ŠëŠ” ë¬¸ìì…ë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ ìš©ë„ë¡œ BOMì„ ì“°ëŠ” ê²ƒì€ ë‚˜ìœ ìƒê°ì…ë‹ˆë‹¤.
ì •ë§ë¡œ zero width no-break spaceê°€ í•„ìš”í•˜ë‹¤ë©´ ìœ ë‹ˆì½”ë“œ 3.2ì— ì¶”ê°€ëœ
`U+2060 WORD JOINER`ì„ ì“°ì„¸ìš”.
(ìœ ë‹ˆì½”ë“œ ë¬¸ìëŠ” í•œë²ˆ ì´ë¦„ì´ ì •í•´ì§€ë©´ ë°”ê¿€ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ì´ëŸ° ì¼ì´ ë²Œì–´ì§‘ë‹ˆë‹¤.)

UTF-16ì—ì„œ ì—”ë””ì•ˆì´ ë’¤ì§‘í ê²½ìš° `U+FEFF`ëŠ” `U+FFFE`ê°€ ë©ë‹ˆë‹¤.
ì´ ë¬¸ìëŠ” ["noncharacter"ë¡œ ì§€ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤][unicode-faq-noncharacter].

# C/C++

C/C++ì—ëŠ” ì „í†µì ìœ¼ë¡œ `char`ì™€ `wchar_t`ê°€ ìˆì§€ë§Œ,
ì•ˆíƒ€ê¹ê²Œë„ ì´ë“¤ì€ í¸í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë…€ì„ì´ ì•„ë‹™ë‹ˆë‹¤.

`wchar_t`ëŠ” C90ì— ì¶”ê°€ë˜ì—ˆìœ¼ë©° "extended character set"ì„ ë‹´ì„ ìˆ˜ ìˆëŠ” íƒ€ì…ì´ì§€ë§Œ,
"extended character"ê°€ ë¬´ì—‡ì¸ì§€ëŠ” êµ¬í˜„ì²´ ë§ˆìŒëŒ€ë¡œì…ë‹ˆë‹¤.
ë¦¬ëˆ…ìŠ¤ì—ì„œ `wchar_t`ëŠ” 32ë¹„íŠ¸ì´ì§€ë§Œ, ìœˆë„ì—ì„œëŠ” 16ë¹„íŠ¸ì…ë‹ˆë‹¤.
ê·¸ëŸ¬ë‹ˆê¹Œ ìœˆë„ì—ì„œëŠ” wchar_tê°€ ìœ ë‹ˆì½”ë“œ ì½”ë“œ í•˜ë‚˜ë¥¼ ì™„ì „íˆ ë‹´ì§€ ëª»í•©ë‹ˆë‹¤.

C++11ì—ëŠ” UTF-16ê³¼ UTF-32ë¥¼ ìœ„í•´ `char16_t`ì™€ `char32_t` íƒ€ì…ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!
ê·¸ë¦¬ê³  unicode literalì„ ìœ„í•´ `u8`, `u`, `U` prefixê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.

```c
char utf8[] = u8"\U00010000";
char16_t utf16[] = u"\U00010000";
char32_t utf32[] = u"\U00010000";
```

ê·¸ë¦¬ê³  unicode literalì—ì„œëŠ” ì˜ëª»ëœ UTF ì¸ì½”ë”©ì„ ëª…ì‹œì ìœ¼ë¡œ ì—ëŸ¬ë¡œ ì·¨ê¸‰í•©ë‹ˆë‹¤.

```c
char16_t surrogate = u'\udc00';
```

```
error: \udc00 is not a valid universal character
```

ë‹¤ë§Œ ì´ íƒ€ì…ì— ìœ ë‹ˆì½”ë“œê°€ ë“¤ì–´ìˆë‹¤ëŠ” ë³´ì¥ì„ í•  ìˆ˜ ì—†ëŠ” ê²ƒì€ ì—¬ì „í•©ë‹ˆë‹¤.
ì˜ˆë¥¼ ë“¤ì–´, ìœ„ì˜ ì˜ˆì œëŠ”

```c
char16_t surrogate = (char16_t)0xdc00;
```

ë¡œ ë°”ê¾¸ë©´ ì—¬ì „íˆ ì»´íŒŒì¼ë©ë‹ˆë‹¤.
ì´ë“¤ì€ (ì˜ˆì „ì—ë„ ê·¸ë¬ë“¯ì´) ëŸ°íƒ€ì„ ìƒì—ì„œ ìˆ˜ë™ìœ¼ë¡œ ì²´í¬í•´ì•¼ í•  ê²ƒì…ë‹ˆë‹¤.

# ìœˆë„ API

ìœˆë„ APIì—ì„œ ê°€ì¥ ë¨¼ì € ê¸°ì–µí•´ì•¼ í•  ë¶€ë¶„ì€ ëŠ” ìœ ë‹ˆì½”ë“œë¥¼ ì‚¬ìš©í•˜ëŠ” APIì™€ ì‹œìŠ¤í…œ localeì„ ì“°ëŠ” APIê°€
[ë³„ë„ë¡œ ì¡´ì¬í•œë‹¤ëŠ” ì ][win-unicode-fn]ì…ë‹ˆë‹¤.
ê°€ë ¹ [MessageBox][MessageBox] í•¨ìˆ˜ëŠ” ì‹¤ì œë¡œëŠ” `MessageBoxW`ì™€ `MessageBoxA` ì¤‘ì˜ í•˜ë‚˜ë¡œ,
ì´ë“¤ì€ í—¤ë”ì— ë‹¤ìŒê³¼ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì •ì˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```c
int WINAPI MessageBoxA(HWND hWnd,LPCSTR lpText,LPCSTR lpCaption,UINT uType);
int WINAPI MessageBoxW(HWND hWnd,LPCWSTR lpText,LPCWSTR lpCaption,UINT uType);

#ifdef UNICODE
    #define MessageBox MessageBoxW
#else
    #define MessageBox MessageBoxA
#endif
```

ìœ ë‹ˆì½”ë“œë¡œ ë©”ì‹œì§€ ë°•ìŠ¤ë¥¼ ë„ìš°ë ¤ë©´ `MessageBoxW(NULL, L"text", L"caption", 0);`ê³¼ ê°™ì´
`wchar_t` ë¬¸ìì—´ì„ ì¨ì•¼ í•©ë‹ˆë‹¤.

ë‹¤ìŒìœ¼ë¡œ ê¸°ì–µí•´ì•¼ í•  ë¶€ë¶„ì€, ìœˆë„ì˜ ìœ ë‹ˆì½”ë“œ APIëŠ” UTF-16ì„ ì‚¬ìš©í•˜ë©°
UTF-16ì˜ 2ë°”ì´íŠ¸ ê°’ë“¤ì„ ë‹´ê¸° ìœ„í•´ `wchar_t`ë¥¼ ì“´ë‹¤ëŠ” ì ì…ë‹ˆë‹¤.
ì´ ì •ì˜ëŠ” ìœˆë„ 2000ì— UCS2ë¥¼ ì“°ë˜ ì‹œì ˆì— ì •ì˜ëœ ê²ƒìœ¼ë¡œ,
ê·¸ ë‹¹ì‹œì—ëŠ” ë¬¸ì í•˜ë‚˜ê°€ `wchar_t` í•˜ë‚˜ì— ëŒ€ì‘í•˜ë‹ˆ í¸ë¦¬í–ˆì„ ìˆ˜ ìˆê² ì§€ë§Œ
ì§€ê¸ˆì€ ê·¸ê²ƒë„ ì•„ë‹ˆë‹ˆê¹Œ ë²ˆì¡í•´ì§€ê¸°ë§Œ í•œ ëŠë‚Œì´ ë“­ë‹ˆë‹¤.

ê·¸ ë‹¤ìŒ ê¸°ì–µí•´ì•¼ í•  ë¶€ë¶„ì€..
ìœˆë„ì˜ ìœ ë‹ˆì½”ë“œ API ì—­ì‹œ ì‚¬ì‹¤ì€ ìœ ë‹ˆì½”ë“œê°€ ì•„ë‹ ìˆ˜ ìˆë‹¤ëŠ” ì ì…ë‹ˆë‹¤.
[CreateFileW][CreateFile] í•¨ìˆ˜ëŠ” íŒŒì¼ëª…ìœ¼ë¡œ `LPCWSTR`(`const wchar_t*`)ë¥¼ ë°›ì§€ë§Œ,
ì¼ë¶€ OSì—ì„œëŠ” ì´ íŒŒì¼ëª…ì´ UTF-16ì— ë§ì§€ ì•Šì•„ë„ íŒŒì¼ì€ ìƒì„±ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ë§ˆì°¬ê°€ì§€ë¡œ, [FindFirstFile][] ê°™ì€ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í–ˆì„ ë•Œ UTF-16ì´ ì•„ë‹Œ íŒŒì¼ëª…ì´ ë‚˜ì˜¬ ìˆ˜ ìˆì„ ê²ƒì´ê³ ìš”.
[GetEnvironmentStrings][] ì—­ì‹œ ë§ˆì°¬ê°€ì§€ì…ë‹ˆë‹¤.
ì´ëŸ¬í•œ ë¶€ë¶„ì— ëŒ€í•´ì„œëŠ” msdnì—ì„œë„ ëª…í™•í•œ ëŒ€ë‹µì„ ê°€ì§€ê³  ìˆì§€ ì•ŠìŠµë‹ˆë‹¤. ì•Œì•„ì„œ ì£¼ì˜í•´ì•¼ê² ì£ .

ìƒë‹¹ìˆ˜ì˜ C/C++ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ UTF-8ì„ ê°€ì •í•˜ëŠ” ê²ƒì— ë¹„í•´ ìœˆë„ APIê°€ UTF-16ì„ ì“´ë‹¤ëŠ” ì ì€
ìœˆë„ ê°œë°œì„ ë‚œí•´í•˜ê²Œ ë§Œë“­ë‹ˆë‹¤.
íŠ¹íˆ ìœˆë„ìš© ë¼ì´ë¸ŒëŸ¬ë¦¬/ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“¤ ê²½ìš° UTF-8ì„ ì¨ì•¼ í• ì§€ UTF-16ì„ ì¨ì•¼ í• ì§€
ê³ ë¯¼í•´ì•¼ í•©ë‹ˆë‹¤.
[utf8everywhere][utf8everywhere-how]ì—ì„œëŠ” ìœˆë„ APIì— ì¢…ì†ì ì¸ ë¶€ë¶„ ì´ì™¸ì—ëŠ” UTF-8ì„ ì‚¬ìš©í•˜ê³ ,
í•„ìš”í•œ ê²½ìš°ì—ë§Œ UTF-16 ë³€í™˜ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤.
ì €ë„ ì—¬ê¸°ì— ë™ì˜í•©ë‹ˆë‹¤.

## C locale

ìœˆë„ì—ì„œëŠ” C í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì¼ë¶€ ì§€ì›ë˜ëŠ”ë°, ì´ë“¤ ì¤‘ ë¬¸ìì—´ í•¨ìˆ˜ì—ëŠ”
`char`ë¥¼ ì‚¬ìš©í•˜ëŠ” ANSI í•¨ìˆ˜ì™€ í•¨ê»˜ `wchar_t`ë¥¼ ì“°ëŠ” wide-character í•¨ìˆ˜ë“¤ì´ í•¨ê»˜ ì§€ì›ë©ë‹ˆë‹¤.
ìœ ë‹ˆì½”ë“œë¥¼ ì œëŒ€ë¡œ ì“°ë ¤ë©´ ì´ë“¤ì„ ì¨ì•¼ í•  ê²ƒì²˜ëŸ¼ ë³´ì´ì§€ë§Œ,
ì‚¬ì‹¤ ì–˜ë„¤ë“¤ì´ ìƒê°ë³´ë‹¤ ì“°ê¸° í¸í•œ ë…€ì„ë“¤ì€ ì•„ë‹™ë‹ˆë‹¤.

[wscanf][] í•¨ìˆ˜ë¥¼ ì˜ˆë¡œ ë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤.

```c
wscanf(L"%ls", &buf);
```

ì»¤ë§¨ë“œ ë¼ì¸ì— "ê°€ë‚˜ë‹¤"ë¥¼ ì…ë ¥í•˜ë©´ `buf`ì—ëŠ” ì–´ë–¤ ê°’ì´ ì €ì¥ë ê¹Œìš”?
`[L'\xac00', L'\xb098', L'\xb2e4']`ê°€ ì €ì¥ë˜ì–´ ìˆì„ ê²ƒ ê°™ì§€ë§Œ ì‹¤ì œë¡œëŠ” ë‹¤ìŒì´ ì €ì¥ë©ë‹ˆë‹¤.

```
[L'\xb0', L'\xa1', L'\xb3', L'\xaa', L'\xb4', L'\xd9]
```

[wcsftime][] í•¨ìˆ˜ ì—­ì‹œ ë§ˆì°¬ê°€ì§€ì…ë‹ˆë‹¤.
`wcsftime(buf, 20, L"%Z", &tm);`ì—ì„œ `buf`ì—ëŠ” ì–´ë–¤ ê°’ì´ ì €ì¥ë ê¹Œìš”?
"ëŒ€í•œë¯¼êµ­ í‘œì¤€ì‹œ"ë¼ëŠ” UTF-16 ë¬¸ìì—´ì´ ë‚˜ì™€ì•¼ í•  ê²ƒ ê°™ì§€ë§Œ ê·¸ë ‡ì§€ ì•ŠìŠµë‹ˆë‹¤.

```
[L'\xb4', L'\xeb', L'\xc7', L'\xd1', L'\xb9', L'\xce', L'\xb1', L'\xb9',
 L'\x20', L'\xc7', L'\xa5', L'\xc1', L'\xd8', L'\xbd', L'\xc3', L'\x00']
```

ì´ê²Œ ë­˜ê¹Œìš”?

ì´ê±´ ì‚¬ì‹¤ì€ ìœˆë„ íŠ¹ìœ ì˜ ë¬¸ì œëŠ” ì•„ë‹ˆê³ , C localeê³¼ ê´€ë ¨ëœ ë¬¸ì œì…ë‹ˆë‹¤.
`wscanf`ë‚˜ `wcsftime` ë“±ì˜ í•¨ìˆ˜ëŠ” C localeì— ì˜ì¡´í•©ë‹ˆë‹¤.
ë¦¬ëˆ…ìŠ¤ ë“±ì˜ ì‹œìŠ¤í…œì—ì„œëŠ” `locale` ëª…ë ¹ì–´ë¥¼ í•´ì„œ ì‹œìŠ¤í…œ localeì„ í™•ì¸í•  ìˆ˜ ìˆì„ ê±°ê³ ìš”.

ì•„ë§ˆë„ `wscanf`ë‚˜ `wcsftime` í•¨ìˆ˜ëŠ” ìš°ì„  `scanf`ë‚˜ `strftime`ì´ ê·¸ëŸ¬í•˜ë“¯ "raw data"ë¥¼ ì–»ìŠµë‹ˆë‹¤.
ì´ ë°ì´í„°ëŠ” í•œêµ­ì–´ ìœˆë„ì—ì„œëŠ” CP949ìœ¼ë¡œ ì¸ì½”ë”©ë˜ì–´ ìˆê² ì£ .
ê·¸ ë‹¤ìŒì—ëŠ” í˜„ì¬ í”„ë¡œê·¸ë¨ì˜ localeì„ ê¸°ì¤€ìœ¼ë¡œ ìœ ë‹ˆì½”ë“œë¡œ ë””ì½”ë“œí•˜ë ¤ê³  ì‹œë„í•©ë‹ˆë‹¤.
í•˜ì§€ë§Œ ì‹œìŠ¤í…œ localeì´ ë¬´ì—‡ì´ë“  ê°„ì—,
C í”„ë¡œê·¸ë¨ ì…ì¥ì—ì„œ C localeì€ ë¬´ì¡°ê±´ `"C"`ë¡œ ì´ˆê¸°í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
ë”°ë¼ì„œ latin1 ì¸ì½”ë”©ì´ ê°€ì •ë˜ê³ , ê·¸ê±¸ UTF-16ìœ¼ë¡œ ë””ì½”ë”©í•œ ê²°ê³¼ê°€ ë¦¬í„´ë©ë‹ˆë‹¤.

ì •ìƒì ì¸ ê²°ê³¼ë¥¼ ì›í•œë‹¤ë©´ C í”„ë¡œê·¸ë¨ localeì„ ëª…ì‹œì ìœ¼ë¡œ ì„¸íŒ…í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.
í”„ë¡œê·¸ë¨ ì´ˆê¸°ì— `setlocale(LC_ALL, "");`ì„ í˜¸ì¶œí•´ì£¼ë©´ ë˜ê² ì£ .

ì‚¬ì‹¤ ìœˆë„ ì´ì™¸ì˜ í”Œë«í¼ì—ì„œëŠ” ì´ëŸ¬í•œ ë¬¸ì œë¥¼ ë§Œë‚  ì¼ì´ ê±°ì˜ ì—†ìŠµë‹ˆë‹¤.
ì• ì´ˆì— ëŒ€ë¶€ë¶„ì˜ ë¦¬ëˆ…ìŠ¤ ì‹œìŠ¤í…œì—ì„œëŠ” ì‹œìŠ¤í…œ localeì´ UTF-8ë¡œ ë˜ì–´ ìˆìœ¼ë‹ˆê¹Œ
C localeì„ ì‹ ê²½ì“¸ ì¼ì´ ë³„ë¡œ ì—†ì£ .
ëª¨ë“  ê²ƒì´ UTF-8ë¡œ ì´ë£¨ì–´ì§€ëŠ” ìƒí™©ì—ì„œ êµ³ì´ wide character í•¨ìˆ˜ë¥¼ ë¶€ë¥¼ ì´ìœ ë„ ì—†ê³ ìš”.
í•˜ì§€ë§Œ ìœˆë„ëŠ” ì‹œìŠ¤í…œ localeì´ CP949 ë“±ì˜ ANSI localeì´ë¼ëŠ” ì ì´ ìƒí™©ì„ ë³µì¡í•˜ê²Œ ë§Œë“­ë‹ˆë‹¤.
ì• ì´ˆì— ìœˆë„ì—ì„œëŠ” C í•¨ìˆ˜ ëŒ€ì‹  ìœˆë„ APIë¥¼ ì§ì ‘ ë¶€ë¥´ëŠ” ê²ƒì´ ì´ìƒí•œ ì‹¤ìˆ˜ë¥¼ ë°©ì§€í•˜ëŠ” ê¸¸ì¸ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

# Java

## Unicode Escape

Javaì—ì„œëŠ” ìœ ë‹ˆì½”ë“œ ë¬¸ìë¥¼ ì…ë ¥í•˜ê¸° ìœ„í•´ `\uXXXX` ë¬¸ë²•ì„ ì§€ì›í•©ë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì´ ì“°ë©´ ë˜ê² ì£ ?

```java
public class HelloWorld {
    public static void main(String[] args) {
        // Hello,\u000AWorld == Hello,\nWorld
        String helloWorld = "Hello,\u000AWorld!";
    }
}
```

ì»´íŒŒì¼ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```
HelloWorld.java:3: error: not a statement
        // Hello,\u000AWorld == Hello,\nWorld
                             ^
HelloWorld.java:3: error: ';' expected
        // Hello,\u000AWorld == Hello,\nWorld
                                     ^
HelloWorld.java:3: error: illegal character: \92
        // Hello,\u000AWorld == Hello,\nWorld
                                      ^
HelloWorld.java:4: error: ';' expected
        String helloWorld = "Hello,\u000AWorld!";
              ^
HelloWorld.java:4: error: unclosed string literal
        String helloWorld = "Hello,\u000AWorld!";
                            ^
HelloWorld.java:4: error: not a statement
        String helloWorld = "Hello,\u000AWorld!";
                                         ^
HelloWorld.java:4: error: ';' expected
        String helloWorld = "Hello,\u000AWorld!";
                                              ^
HelloWorld.java:4: error: unclosed string literal
        String helloWorld = "Hello,\u000AWorld!";
                                               ^
8 errors
```

ë¬¸ì œëŠ” `\uXXXX`ëŠ” [ì‹¤ì œ íŒŒì‹±ì´ ì¼ì–´ë‚˜ê¸° ì „ì— ë³€í™˜ëœë‹¤ëŠ” ì ì…ë‹ˆë‹¤][javase7-lex].

>   A compiler for the Java programming language ("Java compiler") first recognizes Unicode escapes in its input, translating the ASCII characters \u followed by four hexadecimal digits to the UTF-16 code unit (Â§3.1) of the indicated hexadecimal value, and passing all other characters unchanged.

ê·¸ëŸ¬ë‹ˆê¹Œ ìœ„ì˜ ì½”ë“œëŠ” ì‚¬ì‹¤ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```java
public class HelloWorld {
    public static void main(String[] args) {
        // Hello,
World == Hello,\nWorld
        String helloWorld = "Hello,
World!";
    }
}
```

í•œí¸ `\uXXXX`ê°€ íŒŒì‹± ì „ì— ë³€í™˜ë˜ê¸° ë•Œë¬¸ì—, ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.

```java
double \u03C0 = Math.PI;
double pi = Ï€;
```

í˜¹ì€..

```java
\u0064\u006f\u0075\u0062\u006c\u0065\u0020\u03c0\u0020\u003d\u0020\u004d\u0061\u0074\u0068\u002e\u0050\u0049\u003b
```

ì•„, ê·¸ë¦¬ê³  `\uXXXX`ëŠ” ìœ ë‹ˆì½”ë“œ í¬ì¸íŠ¸ê°€ ì•„ë‹ˆë¼ UTF-16 ê°’ì´ë¼ëŠ” ì ë„ ìŠìœ¼ë©´ ì•ˆ ë©ë‹ˆë‹¤.
U+0001F604ë¥¼ ì…ë ¥í•˜ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì¨ì•¼ í•©ë‹ˆë‹¤.

```java
String s = "\ud83d\ude04";
```

## charì™€ String

Javaì—ì„œ `char`ëŠ” [`\u0000`ë¶€í„° `\uffff`ê¹Œì§€ì˜ ê°’ì„ ë‹´ëŠ”][javase7-char] 16ë¹„íŠ¸ íƒ€ì…ì…ë‹ˆë‹¤.
ì¦‰, surrogateë¥¼ í¬í•¨í•˜ë©° supplementary characterë¥¼ ë‹´ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

```java
char surrogate = '\ud800';
```

`String` ì—­ì‹œ ["UTF-16 ì½”ë“œ í¬ì¸íŠ¸ì˜ ì‹œí€€ìŠ¤"][javase7-string]ì…ë‹ˆë‹¤.
ê·¸ëŸ¬ë‹ˆê¹Œ ì–˜ëŠ” UTF-16ì´ê±°ë‚˜,

```java
String smile = "\ud83d\ude04";
System.out.println(smile.length());
System.out.println((long)smile.charAt(0));
```

```
2
55537
```

ì•„ë‹ˆë©´ ê·¸ëƒ¥ surrogateê°€ ì•ˆ ë§ëŠ” ë¶ˆí–‰ì˜ ë¬¸ìì—´ì¼ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```java
String brokenSmile = "\ud83d";
System.out.println(brokenSmile.length());
```

```
1
```

## Modified UTF-8

JNIë¥¼ í•˜ë ¤ë©´ JVMì—ì„œ Stringì´ ì–´ë–»ê²Œ ì €ì¥ë˜ëŠ”ì§€ ì•Œê³  ìˆì–´ì•¼ í•©ë‹ˆë‹¤.
JVM/JNIì—ì„œ ì‚¬ìš©í•˜ëŠ” ë¬¸ìì—´ ì¸ì½”ë”© ë°©ë²•ì„ [Modified UTF-8][jni-modified-utf8]ì´ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤.
Modified UTF-8ì€ UTF-8ê³¼ ë‘ ê°€ì§€ê°€ ë‹¤ë¦…ë‹ˆë‹¤.

-   JavaëŠ” `\uFFFF`ê¹Œì§€ë°–ì— ì¸ì‹í•˜ì§€ ëª»í•˜ë©°, supplementary characterë¥¼ ì…ë ¥í•˜ë ¤ë©´
    surrogate pairë¡œ ë„£ì–´ì•¼ í•©ë‹ˆë‹¤.
    ì˜ˆë¥¼ ë“¤ì–´, U+0001F604ëŠ” ë¨¼ì € U+D83D U+DE04ë¡œ ë¶„ë¦¬í•œ ë‹¤ìŒ ê°ê°ì„ UTF-8ë¡œ ì¸ì½”ë”©í•©ë‹ˆë‹¤.
    (ì´ëŸ¬í•œ ì¸ì½”ë”©ì„ [CESU-8][]ì´ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤.)
    ì¦‰ supplementary characterì˜ ì¸ì½”ë”©ì—ëŠ” 6ë°”ì´íŠ¸ê°€ í•„ìš”í•©ë‹ˆë‹¤.
-   í•œê°€ì§€ ì˜ˆì™¸ê°€ ë” ìˆìŠµë‹ˆë‹¤.
    Java ë¬¸ìì—´ì€ `\0`ì„ í¬í•¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (`"a\0b".length()`ëŠ” `3`ì´ ë‚˜ì˜µë‹ˆë‹¤.)
    í•˜ì§€ë§Œ JNI ê°™ì€ ê³³ì—ì„œëŠ” ë¬¸ìì—´ì˜ ëì— `\0`ì„ ì“°ê¸° ë•Œë¬¸ì— ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    ê·¸ë˜ì„œ `U+0000`ì€ `0x00`ìœ¼ë¡œ ì¸ì½”ë”©í•˜ì§€ ì•Šê³ , ì˜ˆì™¸ì ìœ¼ë¡œ `0xC0 0x80`ìœ¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤.
    ì•¼ìƒì˜ overlong encodingì´ ë“±ì¥í–ˆìŠµë‹ˆë‹¤!

# JavaScript

```
<<< 'ğŸ˜„'.length
>>> 2
<<< 'ğŸ˜„'.charCodeAt(0)
>>> 55357
<<< 'ğŸ˜„' == '\ud83d\ude04'
>>> true
```

:(

ìì„¸í•œ ë‚´ìš©ì€ [JavaScript has a Unicode problem][mathiasbynens-javascript-unicode]ê³¼
[Unicode and Javascript][2ality-javascript-unicode]ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.

# Python

Python 2ì—ì„œëŠ” `str`ê³¼ `unicode` íƒ€ì…ì´,
Python 3ì—ì„œëŠ” `bytes`ì™€ `str` íƒ€ì…ì´ ìˆìŠµë‹ˆë‹¤.
ì „ìëŠ” ìœ ë‹ˆì½”ë“œê°€ ì•„ë‹Œ ì„ì˜ì˜ ë°”ì´íŠ¸ì—´, í›„ìëŠ” ìœ ë‹ˆì½”ë“œ ë¬¸ìì—´ì…ë‹ˆë‹¤.

ì •í™•íˆëŠ” surrogate pairë¥¼ í¬í•¨í•œ ìœ ë‹ˆì½”ë“œì…ë‹ˆë‹¤.

```
# python2
>>> u'\udc00'  # ì—ëŸ¬ ì—†ìŒ
u'\udc00'

# python3
>>> '\udc00'  # ì—­ì‹œ ì—ëŸ¬ ì—†ìŒ
'\udc00'
```

[Python2ì˜ `os.listdir` í•¨ìˆ˜][py2-os]ëŠ”
ë””ë ‰í† ë¦¬ ê²½ë¡œë¥¼ ì…ë ¥ë°›ì•„ ê·¸ ë””ë ‰í† ë¦¬ì— ìˆëŠ” íŒŒì¼ ì´ë¦„ë“¤ì„ ì£¼ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
ì´ë•Œ ê²½ë¡œê°€ ë°”ì´íŠ¸ì—´ì´ë©´ íŒŒì¼ ì´ë¦„ë„ ë°”ì´íŠ¸ì—´ë¡œ ì£¼ë©°,
ê²½ë¡œê°€ ìœ ë‹ˆì½”ë“œ ë¬¸ìì—´ì´ë©´ íŒŒì¼ ì´ë¦„ë„ ìœ ë‹ˆì½”ë“œë¡œ.. ì£¼ë ¤ê³  ë…¸ë ¥í•©ë‹ˆë‹¤.
í•˜ì§€ë§Œ íŒŒì¼ ì´ë¦„ì´ ìœ ë‹ˆì½”ë“œë¡œ ë³€í™˜ë˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ì–´ë–»ê²Œ í• ê¹Œìš”?
ì´ ê²½ìš°ëŠ” ë°”ì´íŠ¸ì—´ì„ ê·¸ëŒ€ë¡œ ë¦¬í„´í•©ë‹ˆë‹¤.

```
$ touch abc
$ touch `echo '\xff'`  # ì´ë¦„ì´ UTF-8ì´ ì•„ë‹Œ íŒŒì¼ì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤. (ì‹œìŠ¤í…œì€ UTF-8 locale)

$ python2
>>> import os
>>> os.listdir('.')
['abc', '\xff']
>>> os.listdir(u'.')
[u'abc', '\xff']
```

ë¬¸ì œëŠ” Python3ì…ë‹ˆë‹¤. Python3ì—ì„œëŠ” [`str`ì„ ë°›ìœ¼ë©´ `str`ì„ ë¦¬í„´í•œë‹¤ê³  í•©ë‹ˆë‹¤][py3-os].
ì–´ë–»ê²Œ ë ê¹Œìš”?

```
$ python3
>>> import os
>>> os.listdir(b'.')
[b'abc', b'\xff']
>>> os.listdir(u'.')
['abc', '\udcff']
```

ì•¼ìƒì˜ surrogate `U+DCFF`ê°€ ë“±ì¥í–ˆìŠµë‹ˆë‹¤!

Python3ì—ì„œëŠ” ìœ ë‹ˆì½”ë“œ ë³€í™˜ì— ì‹¤íŒ¨í•œ ê²½ìš° ê·¸ ë°”ì´íŠ¸ë¥¼ `U+DC??`ë¡œ ë³€í™˜í•˜ëŠ”
"surrogateescape" í´ë°± ì¸ì½”ë”©ì´ ìˆìŠµë‹ˆë‹¤.
ê·¸ë¦¬ê³  os ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ê·¸ê±¸ ì‚¬ìš©í•˜ê³  ìˆê³ ìš”.
ì´ëŸ¬í•œ surrogateì˜ ì¡´ì¬ëŠ” ì—‰ëš±í•œ ê³³ì—ì„œ í­ë°œí•  ìš°ë ¤ê°€ ìˆìŠµë‹ˆë‹¤.
ìœ ë‹ˆì½”ë“œ ë¬¸ìì—´ì´ë¼ê³  ìƒê°í–ˆëŠ”ë° `encode('utf-8')`ì´ ì‹¤íŒ¨í•˜ëŠ” ê±´ ë³„ë¡œ ë§ˆìŒì— ë“œëŠ” ê²°ê³¼ëŠ” ì•„ë‹ˆì£ .

```
$ python3
>>> a = '\udcff'
>>> a.encode('utf-8')
UnicodeEncodeError: 'utf-8' codec can't encode character '\udcff' in position 0: surrogates not allowed
>>> print(a)
UnicodeEncodeError: 'utf-8' codec can't encode character '\udcff' in position 0: surrogates not allowed
```

Pythonê³„ì˜ ì•„ì´ëŒ mitsuhikoëŠ” [ì—¬ëŸ¬][mitsuhiko-guide-to-unicode] [ì°¨ë¡€][mitsuhiko-everything-about-unicode]
Python3ì˜ ìœ ë‹ˆì½”ë“œ ìƒí™©ì— ëŒ€í•´ ë¶ˆí‰í•œ ì ì´ ìˆìŠµë‹ˆë‹¤. í•œë²ˆì¯¤ ì½ì–´ë³´ë©´ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

# Go

Goì—ëŠ” [`rune`ì´ë¼ëŠ” ìë£Œí˜•][go-rune]ì´ ìˆìŠµë‹ˆë‹¤.
ì´ íƒ€ì…ì€ `int32` í¬ê¸°ë¥¼ ê°€ì§€ë©°, ìœ ë‹ˆì½”ë“œ ë¬¸ì í•˜ë‚˜ë¥¼ ì˜¨ì „íˆ ë‹´ê¸° ìœ„í•´ ì¡´ì¬í•©ë‹ˆë‹¤.
ë˜í•œ UTF-8 ë¬¸ìì—´ì„ ë‹´ê¸° ìœ„í•´ `string` íƒ€ì…ì´ ì¡´ì¬í•©ë‹ˆë‹¤.
ì•„ì‰¬ìš´ ì ì´ ìˆë‹¤ë©´ ì´ íƒ€ì…ë“¤ì´ ìœ ë‹ˆì½”ë“œë¥¼ ë‹´ì„ ê²ƒì´ë¼ëŠ” ê²ƒì€ ì•”ì‹œì ì¸ ê°€ì •ì¼ ë¿ì´ë¼ëŠ” ì ì…ë‹ˆë‹¤.
(C++11ê³¼ ë¹„ìŠ·í•œ ìˆ˜ì¤€ìœ¼ë¡œ ì§€ì›ëœë‹¤ê³  ìƒê°í•˜ë©´ ë  ê²ƒ ê°™ìŠµë‹ˆë‹¤.)

ì˜ˆë¥¼ ë“¤ë©´, rune literalì— surrogateë¥¼ ë‹´ëŠ” ê²ƒì€ ì»´íŒŒì¼ ì˜¤ë¥˜ì´ì§€ë§Œ..

```go
r := '\udc00';
```

```
invalid Unicode code point in escape sequence: 0xdc00
```

runeì— surrogateë¥¼ ë‹´ëŠ” ê²ƒ ìì²´ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

```go
r := rune(0xdc00);
```

ì´ë“¤ì€ ëŸ°íƒ€ì„ ìƒì—ì„œ ì§ì ‘ ì²´í¬ë˜ì–´ì•¼ í•˜ê² ì£ .
ê°€ë ¹ `fmt.Printf("%s", string(0xdc00))`ëŠ” `U+FFFD`ë¥¼ ì¶œë ¥í•˜ë„ë¡ ì²˜ë¦¬ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

# Rust

Rustì—ëŠ” [`char` ìë£Œí˜•][rust-char]ì´ ìˆìŠµë‹ˆë‹¤.
ì´ íƒ€ì…ì€ ìœ ë‹ˆì½”ë“œ scalar valueë¥¼ ê°€ì§€ë©°(surrogate ì œì™¸) ë‚´ë¶€ì ìœ¼ë¡œëŠ” `u32`ë¡œ í‘œí˜„ë©ë‹ˆë‹¤.
ì—­ì‹œ ë§ˆì°¬ê°€ì§€ë¡œ `String`ê³¼ `&str` ìë£Œí˜•ì€ ìœ ë‹ˆì½”ë“œ ë¬¸ìì—´ì´ë©° ë‚´ë¶€ì ìœ¼ë¡œëŠ” UTF-8ë¡œ í‘œí˜„ë©ë‹ˆë‹¤.

ì—¬ê¸°ì—ì„œ RustëŠ” `char`ì™€ `String`/`&str` íƒ€ì…ì´ í•­ìƒ ìœ ë‹ˆì½”ë“œê°€ ë˜ë„ë¡ íƒ€ì… ì‹œìŠ¤í…œìœ¼ë¡œ ê°•ì œí•©ë‹ˆë‹¤.
ì—¬ê¸°ì„œ ê°•ì œí•œë‹¤ëŠ” ì˜ë¯¸ëŠ”,
ìœ ë‹ˆì½”ë“œê°€ ì•„ë‹Œ íƒ€ì…ì—ì„œ ìœ ë‹ˆì½”ë“œ íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ê²ƒì´ ì•”ì‹œì ìœ¼ë¡œ ë¶ˆê°€ëŠ¥í•˜ë©°
íƒ€ì… ë³€í™˜ì„ í•˜ë ¤ë©´ ìœ ë‹ˆì½”ë“œ ì²´í¬ ë£¨í‹´ì´ í¬í•¨ëœ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤ëŠ” ë§ì…ë‹ˆë‹¤.

`char`ëŠ” `U+0000`ë¶€í„° `U+10FFFF`ê¹Œì§€ì˜ ê°’ì´ì–´ì•¼ í•˜ë©° surrogateë¥¼ ë¶ˆí—ˆí•©ë‹ˆë‹¤.
ì„ì˜ì˜ ìˆ«ìë¥¼ `char`ë¡œ ë©‹ëŒ€ë¡œ ë³€í™˜í•˜ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥í•˜ë©°,
`std::char::from_u32(u32)` í•¨ìˆ˜ë¥¼ í†µí•´ `Option<char>`ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ë§Œì•½ ì…ë ¥ì´ ì •ìƒì ì¸ ìœ ë‹ˆì½”ë“œê°€ ì•„ë‹ˆë¼ë©´ `None`ì´ ë¦¬í„´ë˜ë©°, ì •ìƒì ì¸ ê²½ìš° `Some(char)`ë¥¼ ì–»ìŠµë‹ˆë‹¤.

ë§ˆì°¬ê°€ì§€ë¡œ, `String`ì€ ì •ìƒì ì¸ UTF-8 ì¸ì½”ë”©ì´ì–´ì•¼ í•˜ë©° overlong sequenceê°€ ì¡´ì¬í•˜ì§€ ì•Šì•„ì•¼ í•©ë‹ˆë‹¤.
`Vec<u8>`ì„ `String`ìœ¼ë¡œ ë³€í™˜í•˜ë ¤ë©´ `std::str::from_utf8`ë¡œ `Option<&str>`ë¥¼ ì–»ê±°ë‚˜,
í˜¹ì€ `std::str::from_utf_lossy`ë¥¼ í†µí•´ ì˜ëª»ëœ ë°”ì´íŠ¸ë¥¼ `U+FFFD`ë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤.

ì¡°ê¸ˆ í”¼ê³¤í•˜ê¸´ í•˜ì§€ë§Œ 'ì•ˆì „'í•˜ë‹¤ëŠ” ê²ƒì€ ë³´ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì¡°ê¸ˆ í”¼ê³¤í•˜ê¸´ í•˜ì§€ë§Œ..

[MessageBox]: http://msdn.microsoft.com/en-us/library/windows/desktop/ms645505%28v=vs.85%29.aspx
[win-unicode-fn]: http://msdn.microsoft.com/en-us/library/windows/desktop/dd317766%28v=vs.85%29.aspx
[CreateFile]: http://msdn.microsoft.com/en-us/library/windows/desktop/aa363858%28v=vs.85%29.aspx
[FindFirstFile]: http://msdn.microsoft.com/en-us/library/windows/desktop/aa364418%28v=vs.85%29.aspx
[wcsftime]: http://msdn.microsoft.com/en-us/library/fe06s4ak.aspx
[wscanf]: http://msdn.microsoft.com/en-us/library/9y6s16x1.aspx
[GetEnvironmentStrings]: http://msdn.microsoft.com/en-us/library/windows/desktop/ms683187%28v=vs.85%29.aspx
[py2-os]: https://docs.python.org/2/library/os.html
[py3-os]: https://docs.python.org/3/library/os.html
[mitsuhiko-guide-to-unicode]: http://lucumr.pocoo.org/2013/7/2/the-updated-guide-to-unicode/
[mitsuhiko-everything-about-unicode]: http://lucumr.pocoo.org/2014/5/12/everything-about-unicode/
[utf8everywhere-how]: http://utf8everywhere.org/#how
[mathiasbynens-javascript-unicode]: http://mathiasbynens.be/notes/javascript-unicode
[2ality-javascript-unicode]: http://www.2ality.com/2013/09/javascript-unicode.html
[javase7-lex]: http://docs.oracle.com/javase/specs/jls/se7/html/jls-3.html
[javase7-string]: http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.3.3
[javase7-char]: http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.2.1
[jni-modified-utf8]: http://docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/types.html
[go-rune]: http://golang.org/pkg/builtin/#rune
[capec-80]: https://capec.mitre.org/data/definitions/80.html
[unicode-faq-bom]: http://www.unicode.org/faq/utf_bom.html#BOM
[unicode-fe70]: http://www.unicode.org/charts/PDF/UFE70.pdf
[CESU-8]: http://www.unicode.org/reports/tr26/
[unicode-faq-noncharacter]: http://www.unicode.org/faq/private_use.html#noncharacters
[unicode-scalar-value]: http://www.unicode.org/glossary/#unicode_scalar_value
[rust-char]: http://doc.rust-lang.org/rust.html#textual-types
